@Configuration
@EnableTransactionManagement
@EnableJpaRepositories(
		basePackages = {"cwp.services.adhoc_processor.repository.acs" }, 
		entityManagerFactoryRef = "acsEntityManagerFactory", 
		transactionManagerRef = "acsTransactionManager")

public class AcsDatasourceConfiguration {

	@Autowired
	private AcsDbProperties properties;

	@Validated
	@Component
	@ConfigurationProperties(prefix = "acs.read.datasource")
	public class AcsDbProperties extends HikariDBProperties {
	}

	@ConditionalOnBean(value = AcsDbProperties.class)
	@Bean(name = "acsDataSource", destroyMethod = "")
	public DataSource acsDataSource() {
		return new HikariDataSource(new HikariConfig(properties.getProperties()));
	}

	@Bean(name = "acsEntityManagerFactory")
	public LocalContainerEntityManagerFactoryBean acsEntityManagerFactory(EntityManagerFactoryBuilder builder) {
		return builder.dataSource(acsDataSource())
				.packages("cwp.services.adhoc_processor.domain.acs" )
				.persistenceUnit("acs")
				.build();
	}

	
	@Bean
	public PlatformTransactionManager acsTransactionManager
			(
			@Qualifier("acsEntityManagerFactory")
			final  LocalContainerEntityManagerFactoryBean acsEntityManagerFactory
			) {
		
				return new JpaTransactionManager(acsEntityManagerFactory.getObject());
	}
	

}
